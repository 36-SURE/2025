<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.30">

  <meta name="author" content=" SURE 2025 Department of Statistics &amp; Data Science Carnegie Mellon University">
  <title>SURE 2025 – Unsupervised learning: principal component analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-97331e35b7c4b061e26f0e6fc4589e47.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Unsupervised learning: principal component analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<br>SURE 2025<br><br>Department of Statistics &amp; Data Science<br>Carnegie Mellon University 
</div>
</div>
</div>

</section>
<section>
<section id="background" class="title-slide slide level1 center">
<h1>Background</h1>

</section>
<section id="unsupervised-learning" class="slide level2">
<h2>Unsupervised learning</h2>
<ul>
<li>No response variable (i.e., data are not labeled)</li>
</ul>
<div class="fragment">
<ul>
<li>Only given a set of features measured on a set of observations</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Unsupervised learning is more subjective than supervised learning (difficult to tell how “good” you are doing)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>There is no simple goal for the analysis, such as prediction of a response in supervised learning</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Unsupervised learning can be useful as a pre-processing step for supervised learning</li>
</ul>
</div>
<div class="fragment">
<p>Think of unsupervised learning as <strong>an extension of EDA—there’s no unique right answer!</strong></p>
</div>
</section>
<section id="fundamental-problems-in-unsupervised-learning" class="slide level2">
<h2>Fundamental problems in unsupervised learning</h2>
<ol type="1">
<li><strong>Dimension reduction:</strong> reduce the original dimension of the data to something smaller so we can explore/visualize the data</li>
</ol>
<ul>
<li>Methods: <strong>PCA (this lecture)</strong>, ICA, t-SNE, UMAP,…</li>
</ul>
<ol start="2" type="1">
<li><strong>Clustering</strong>: group the observations in the data into different clusters</li>
</ol>
<ul>
<li>Methods: hard clustering (<span class="math inline">\(k\)</span>-means, hierachical clustering,…), soft clustering (mixture model)</li>
</ul>
</section>
<section id="dimension-reduction-the-big-picture" class="slide level2">
<h2>Dimension reduction: the big picture</h2>
<p><strong>Key question: How do we visualize the structure of high-dimensional data?</strong></p>
<div class="fragment">
<p>Example: What if you’re given a dataset with 50 variables and are asked to make one visualization that best represents the data? What do you do?</p>
</div>
<div class="fragment">
<p>Tedious task: Make a series of all <span class="math inline">\(\displaystyle \binom{50}{2} = 1225\)</span> pairs of plots? Or make a giant correlation heatmap?</p>
</div>
<div class="fragment">
<p><strong>Intuition: Take high-dimensional data and represent it in 2-3 dimensions, then visualize those dimensions</strong></p>
</div>
</section>
<section id="motivating-example-starbucks-drinks" class="slide level2">
<h2>Motivating example: Starbucks drinks</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>())</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a>starbucks <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-12-21/starbucks.csv"</span></span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert columns to numeric that were saved as character</span></span>
<span id="cb1-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trans_fat_g =</span> <span class="fu">as.numeric</span>(trans_fat_g), <span class="at">fiber_g =</span> <span class="fu">as.numeric</span>(fiber_g))</span>
<span id="cb1-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(starbucks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,147
Columns: 15
$ product_name    &lt;chr&gt; "brewed coffee - dark roast", "brewed coffee - dark ro…
$ size            &lt;chr&gt; "short", "tall", "grande", "venti", "short", "tall", "…
$ milk            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, …
$ whip            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ serv_size_m_l   &lt;dbl&gt; 236, 354, 473, 591, 236, 354, 473, 591, 236, 354, 473,…
$ calories        &lt;dbl&gt; 3, 4, 5, 5, 3, 4, 5, 5, 3, 4, 5, 5, 3, 4, 5, 5, 35, 50…
$ total_fat_g     &lt;dbl&gt; 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1,…
$ saturated_fat_g &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,…
$ trans_fat_g     &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,…
$ cholesterol_mg  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10,…
$ sodium_mg       &lt;dbl&gt; 5, 10, 10, 10, 5, 10, 10, 10, 5, 5, 5, 5, 5, 5, 5, 5, …
$ total_carbs_g   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, …
$ fiber_g         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ sugar_g         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, …
$ caffeine_mg     &lt;dbl&gt; 130, 193, 260, 340, 15, 20, 25, 30, 155, 235, 310, 410…</code></pre>
</div>
</div>
</section>
<section id="dimension-reduction-the-big-picture-1" class="slide level2">
<h2>Dimension reduction: the big picture</h2>
<ul>
<li>It’s usually really hard to visualize many dimensions at the same time</li>
</ul>
<div class="fragment">
<ul>
<li>Often, it makes a lot of sense to choose 2-3 of the “most important dimensions” and just plot those</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>PCA is a very common way to define “most important dimensions”</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>PCA provides the linear combinations of variables that capture the most variation in the data</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>It’s common to plot the first two principal components in a scatterplot</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>It’s very useful to plot principal components with a biplot</p>
<ul>
<li>Adds interpretability to the principal components, and helps reveal relationships among the variables</li>
</ul></li>
</ul>
</div>
</section>
<section id="what-is-the-goal-of-dimension-reduction" class="slide level2">
<h2>What is the goal of dimension reduction?</h2>
<p>We have <span class="math inline">\(p\)</span> variables (columns) for <span class="math inline">\(n\)</span> observations (rows) <strong>BUT</strong> which variables are <strong>interesting</strong>?</p>
<div class="fragment">
<p>Can we find a smaller number of dimensions that captures the <strong>interesting</strong> structure in the data?</p>
<ul>
<li><p>Could examine all pairwise scatterplots of each variable - tedious, manual process</p></li>
<li><p>Clustering of variables based on correlation</p></li>
<li><p>Can we find a combination of the original <span class="math inline">\(p\)</span> variables?</p></li>
</ul>
</div>
<div class="fragment">
<p><strong>Dimension reduction</strong>:</p>
<ul>
<li><p>Focus on reducing the dimensionality of the feature space (i.e., number of columns)</p></li>
<li><p><strong>Retain</strong> most of the information / <strong>variability</strong> in a lower dimensional space (i.e., reducing the number of columns)</p></li>
<li><p>The process: (big) <span class="math inline">\(n \times p\)</span> matrix <span class="math inline">\(\longrightarrow\)</span> dimension reduction method <span class="math inline">\(\longrightarrow\)</span> (smaller) <span class="math inline">\(n \times k\)</span> matrix</p></li>
</ul>
</div>
</section>
<section id="principal-components-analysis-pca" class="slide level2">
<h2><a href="https://en.wikipedia.org/wiki/Principal_component_analysis">Principal components analysis (PCA)</a></h2>
<p><strong>TL;DR</strong></p>
<p>PCA replaces the original <span class="math inline">\(p\)</span> explanatory variables by fewer linear combinations of them (the “principal components”) that are uncorrelated while also accounting for most of their variabillity</p>
<div class="fragment">
<p><span class="math display">\[
\begin{pmatrix}
&amp; &amp; \text{really} &amp; &amp; \\
&amp; &amp; \text{wide} &amp; &amp; \\
&amp; &amp; \text{matrix} &amp; &amp;
\end{pmatrix}
\rightarrow \text{matrix algebra razzmatazz} \rightarrow
\begin{pmatrix}
\text{much}  \\
\text{thinner}  \\
\text{matrix}
\end{pmatrix}
\]</span></p>
<ul>
<li><p>PCA explores the <strong>covariance</strong> between variables, and combines variables into a smaller set of <strong>uncorrelated</strong> variables called <strong>principal components (PCs)</strong></p>
<ul>
<li>Turn a <span class="math inline">\(n \times p\)</span> matrix of <strong>correlated</strong> variables into a <span class="math inline">\(n \times k\)</span> matrix of <strong>uncorrelated</strong> variables</li>
</ul></li>
</ul>
</div>
</section>
<section id="principal-components-analysis-pca-1" class="slide level2">
<h2><a href="https://en.wikipedia.org/wiki/Principal_component_analysis">Principal components analysis (PCA)</a></h2>
<p><span class="math display">\[
\begin{pmatrix}
&amp; &amp; \text{really} &amp; &amp; \\
&amp; &amp; \text{wide} &amp; &amp; \\
&amp; &amp; \text{matrix} &amp; &amp;
\end{pmatrix}
\rightarrow \text{matrix algebra razzmatazz} \rightarrow
\begin{pmatrix}
\text{much}  \\
\text{thinner}  \\
\text{matrix}
\end{pmatrix}
\]</span></p>
<ul>
<li><p>Each of the <span class="math inline">\(k\)</span> columns in the right-hand matrix are <strong>principal components</strong> (PCs), all uncorrelated with each other</p>
<ul>
<li><p>PCs are <strong>weighted</strong>, linear combinations of the original variables</p></li>
<li><p>Weights reveal how different variables are <strong><em>loaded</em></strong> into the PCs</p></li>
</ul></li>
<li><p>First column accounts for most variation in the data, second column for second-most variation, and so on</p></li>
</ul>
<p>Intuition: we want a <strong>small number of PCs</strong> (first few PCs) to account for most of the information/variance in the data</p>
</section>
<section id="what-are-principal-components" class="slide level2">
<h2>What are principal components?</h2>
<p>Assume <span class="math inline">\(\boldsymbol{X}\)</span> is a <span class="math inline">\(n \times p\)</span> matrix that is <strong>centered</strong> and <strong>stardardized</strong></p>
<div class="fragment">
<p><em>Total variation</em> <span class="math inline">\(= p\)</span>, since <span class="math inline">\(\text{Var}(\boldsymbol{x}_j)\)</span> = 1 for all <span class="math inline">\(j = 1, \dots, p\)</span> (due to stardardization)</p>
</div>
<div class="fragment">
<p>PCA will give us <span class="math inline">\(p\)</span> principal components that are <span class="math inline">\(n\)</span>-length columns, denoted by <span class="math inline">\(Z_1, \dots, Z_p\)</span></p>
</div>
<div class="fragment">
<ul>
<li><p>The first principal component is the linear combination that has the largest possible variance</p></li>
<li><p>Each succeeding component has the largest possible variance under the constraint that it is uncorrelated with the preceding components</p></li>
<li><p>A small number of principal components often explains a high percentage of the original variability</p></li>
</ul>
</div>
</section>
<section id="first-principal-component" class="slide level2">
<h2>First principal component</h2>
<p><span class="math display">\[Z_1 = \phi_{11} X_1 + \phi_{21} X_2 + \dots + \phi_{p1} X_p\]</span></p>
<div class="fragment">
<ul>
<li><p><span class="math inline">\(\phi_{j1}\)</span> are the weights indicating the contributions of each variable <span class="math inline">\(j \in 1, \dots, p\)</span></p></li>
<li><p>Weights are normalized <span class="math inline">\(\displaystyle \sum_{j=1}^p \phi_{j1}^2 = 1\)</span></p></li>
<li><p><span class="math inline">\(\phi_{1} = (\phi_{11}, \phi_{21}, \dots, \phi_{p1})\)</span> is the <strong>loading vector</strong> for <span class="math inline">\(\text{PC}_1\)</span></p></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\(Z_1\)</span> is a linear combination of the <span class="math inline">\(p\)</span> variables that has the <strong>largest variance</strong></li>
</ul>
</div>
</section>
<section id="second-principal-component" class="slide level2">
<h2>Second principal component</h2>
<p><span class="math display">\[Z_2 = \phi_{12} X_1 + \phi_{22} X_2 + \dots + \phi_{p2} X_p\]</span></p>
<ul>
<li><p><span class="math inline">\(\phi_{j2}\)</span> are the weights indicating the contributions of each variable <span class="math inline">\(j \in 1, \dots, p\)</span></p></li>
<li><p>Weights are normalized <span class="math inline">\(\displaystyle \sum_{j=1}^p \phi_{j1}^2 = 1\)</span></p></li>
<li><p><span class="math inline">\(\phi_{2} = (\phi_{12}, \phi_{22}, \dots, \phi_{p2})\)</span> is the <strong>loading vector</strong> for <span class="math inline">\(\text{PC}_2\)</span></p></li>
<li><p><span class="math inline">\(Z_2\)</span> is a linear combination of the <span class="math inline">\(p\)</span> variables that has the <strong>largest variance</strong></p>
<ul>
<li><strong>Subject to constraint it is uncorrelated with <span class="math inline">\(Z_1\)</span></strong></li>
</ul></li>
</ul>
<div class="fragment">
<p>Repeat this process to create <span class="math inline">\(p\)</span> principal components</p>
<ul>
<li><p><strong>Uncorrelated</strong>: Each (<span class="math inline">\(Z_j, Z_{j'}\)</span>) is uncorrelated with each other</p></li>
<li><p><strong>Ordered Variance</strong>: <span class="math inline">\(\text{Var}(Z_1) &gt; \text{Var}(Z_2) &gt; \dots &gt; \text{Var}(Z_p)\)</span></p></li>
<li><p><strong>Total Variance</strong>: <span class="math inline">\(\displaystyle \sum_{j=1}^p \text{Var}(Z_j) = p\)</span></p></li>
</ul>
</div>
</section>
<section id="visualizing-pca-in-two-dimensions" class="slide level2">
<h2><a href="https://www.stevejburr.com/post/scatter-plots-and-best-fit-lines/">Visualizing PCA</a> in two dimensions</h2>

<img data-src="05-pca_files/figure-revealjs/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="visualizing-pca-in-two-dimensions-1" class="slide level2">
<h2><a href="https://www.stevejburr.com/post/scatter-plots-and-best-fit-lines/">Visualizing PCA</a> in two dimensions</h2>

<img data-src="05-pca_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="visualizing-pca-in-two-dimensions-2" class="slide level2">
<h2><a href="https://www.stevejburr.com/post/scatter-plots-and-best-fit-lines/">Visualizing PCA</a> in two dimensions</h2>

<img data-src="05-pca_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="visualizing-pca-in-two-dimensions-3" class="slide level2">
<h2><a href="https://www.stevejburr.com/post/scatter-plots-and-best-fit-lines/">Visualizing PCA</a> in two dimensions</h2>

<img data-src="05-pca_files/figure-revealjs/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="visualizing-pca-in-two-dimensions-4" class="slide level2">
<h2><a href="https://www.stevejburr.com/post/scatter-plots-and-best-fit-lines/">Visualizing PCA</a> in two dimensions</h2>
<p>Key idea: provide low-dimensional linear surfaces that are closest to the observations</p>

<img data-src="05-pca_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1344"><div class="fragment">
<ul>
<li>The above is the <strong>minimizing projection residuals</strong> viewpoint of PCA</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>There’s another viewpoint: <strong>maximizing variance</strong></p>
<ul>
<li>if we project all points onto the solid orange line, we maximize the variance of the resulting projected points across all such orange lines</li>
</ul></li>
</ul>
</div>
</section></section>
<section>
<section id="examples" class="title-slide slide level1 center">
<h1>Examples</h1>

</section>
<section id="data-nutritional-information-of-starbucks-drinks" class="slide level2">
<h2>Data: nutritional information of Starbucks drinks</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>())</span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a>starbucks <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb3-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-12-21/starbucks.csv"</span></span>
<span id="cb3-5"><a aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert columns to numeric that were saved as character</span></span>
<span id="cb3-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trans_fat_g =</span> <span class="fu">as.numeric</span>(trans_fat_g), <span class="at">fiber_g =</span> <span class="fu">as.numeric</span>(fiber_g))</span>
<span id="cb3-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(starbucks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,147
Columns: 15
$ product_name    &lt;chr&gt; "brewed coffee - dark roast", "brewed coffee - dark ro…
$ size            &lt;chr&gt; "short", "tall", "grande", "venti", "short", "tall", "…
$ milk            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, …
$ whip            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ serv_size_m_l   &lt;dbl&gt; 236, 354, 473, 591, 236, 354, 473, 591, 236, 354, 473,…
$ calories        &lt;dbl&gt; 3, 4, 5, 5, 3, 4, 5, 5, 3, 4, 5, 5, 3, 4, 5, 5, 35, 50…
$ total_fat_g     &lt;dbl&gt; 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1,…
$ saturated_fat_g &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,…
$ trans_fat_g     &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,…
$ cholesterol_mg  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10,…
$ sodium_mg       &lt;dbl&gt; 5, 10, 10, 10, 5, 10, 10, 10, 5, 5, 5, 5, 5, 5, 5, 5, …
$ total_carbs_g   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, …
$ fiber_g         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ sugar_g         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, …
$ caffeine_mg     &lt;dbl&gt; 130, 193, 260, 340, 15, 20, 25, 30, 155, 235, 310, 410…</code></pre>
</div>
</div>
</section>
<section id="implementing-pca" class="slide level2">
<h2>Implementing PCA</h2>
<p>Use the <code>prcomp()</code> function (based on SVD) for PCA on centered and scaled data</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a>feat <span class="ot">&lt;-</span> starbucks <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(serv_size_m_l<span class="sc">:</span>caffeine_mg)</span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a>starbucks_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(feat, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(starbucks_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3     PC4     PC5     PC6    PC7
Standard deviation     2.4748 1.3074 1.0571 0.97919 0.67836 0.56399 0.4413
Proportion of Variance 0.5568 0.1554 0.1016 0.08716 0.04183 0.02892 0.0177
Cumulative Proportion  0.5568 0.7122 0.8138 0.90093 0.94276 0.97168 0.9894
                           PC8     PC9    PC10    PC11
Standard deviation     0.28123 0.16874 0.08702 0.04048
Proportion of Variance 0.00719 0.00259 0.00069 0.00015
Cumulative Proportion  0.99657 0.99916 0.99985 1.00000</code></pre>
</div>
</div>
</section>
<section id="computing-principal-components" class="slide level2">
<h2>Computing principal components</h2>
<p>Extract the matrix of principal components (dimension will match original data)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a>starbucks_pc_matrix <span class="ot">&lt;-</span> starbucks_pca<span class="sc">$</span>x</span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(starbucks_pc_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           PC1        PC2        PC3           PC4         PC5         PC6
[1,] -3.766852 -1.0023657  0.2482698 -0.1521871448  0.24739830 -0.11365847
[2,] -3.633234 -0.6946439  1.2059943 -0.3720566566  0.06052789 -0.06406410
[3,] -3.518063 -0.3981399  2.2165170 -0.5967175941 -0.13122572 -0.01937237
[4,] -3.412061 -0.1067045  3.3741594 -0.8490378243 -0.26095965 -0.00899485
[5,] -3.721426 -0.9868147 -1.0705094  0.0949330091 -0.27181508  0.17491809
[6,] -3.564899 -0.6712499 -0.7779083 -0.0003019903 -0.72054963  0.37005543
             PC7         PC8        PC9       PC10        PC11
[1,] -0.02812472 0.006489978 0.05145094 0.06678083 0.019741873
[2,]  0.05460952 0.021148978 0.07094211 0.08080545 0.023480029
[3,]  0.09050806 0.031575955 0.08901403 0.09389227 0.028669251
[4,]  0.11585507 0.037521689 0.11287190 0.11582260 0.034691142
[5,]  0.07009414 0.037736197 0.02892317 0.03631676 0.005775410
[6,]  0.20236484 0.068154160 0.03705252 0.03497690 0.002469611</code></pre>
</div>
</div>
<p>Columns are uncorrelated, such that <span class="math inline">\(\text{Var}(Z_1) &gt; \text{Var}(Z_2) &gt; \dots &gt; \text{Var}(Z_p)\)</span></p>
</section>
<section id="visualizing-first-two-principal-components" class="slide level2">
<h2>Visualizing first two principal components</h2>
<div class="columns">
<div class="column" style="text-align: left;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a>starbucks <span class="ot">&lt;-</span> starbucks <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pc1 =</span> starbucks_pc_matrix[,<span class="dv">1</span>], </span>
<span id="cb9-3"><a aria-hidden="true" tabindex="-1"></a>         <span class="at">pc2 =</span> starbucks_pc_matrix[,<span class="dv">2</span>])</span>
<span id="cb9-4"><a aria-hidden="true" tabindex="-1"></a>starbucks <span class="sc">|&gt;</span> </span>
<span id="cb9-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pc1, <span class="at">y =</span> pc2)) <span class="sc">+</span></span>
<span id="cb9-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"PC 1"</span>, <span class="at">y =</span> <span class="st">"PC 2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Principal components are not interpretable</p></li>
<li><p>Make a <strong>biplot</strong> with arrows showing the linear relationship between one variable and other variables</p></li>
</ul>
</div><div class="column" style="text-align: left;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-pca_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="making-pcs-interpretable-with-biplots" class="slide level2">
<h2>Making PCs interpretable with biplots</h2>
<p>Biplot displays both the space of observations and the space of variables</p>
<p>Check out the <a href="http://www.sthda.com/english/wiki/factoextra-r-package-easy-multivariate-data-analyses-and-elegant-visualization"><code>factoextra</code></a> package</p>
<div class="columns">
<div class="column" style="text-align: left;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># fviz_pca_var(): projection of variables</span></span>
<span id="cb10-3"><a aria-hidden="true" tabindex="-1"></a><span class="co"># fviz_pca_ind(): display observations with first two PCs</span></span>
<span id="cb10-4"><a aria-hidden="true" tabindex="-1"></a>starbucks_pca <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_pca_biplot</span>(<span class="at">label =</span> <span class="st">"var"</span>,</span>
<span id="cb10-6"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha.ind =</span> <span class="fl">0.25</span>,</span>
<span id="cb10-7"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha.var =</span> <span class="fl">0.75</span>,</span>
<span id="cb10-8"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">col.var =</span> <span class="st">"darkblue"</span>,</span>
<span id="cb10-9"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Arrow direction: “as the variable increases…”</p></li>
<li><p>Arrow angles: correlation</p>
<ul>
<li><span class="math inline">\(90^{\circ}\)</span>: uncorrelated</li>
<li><span class="math inline">\(&lt; 90^{\circ}\)</span>: positively correlated</li>
<li><span class="math inline">\(&gt; 90^{\circ}\)</span>: negatively correlated</li>
</ul></li>
<li><p>Arrow length: strength of relationship with PCs</p></li>
</ul>
</div><div class="column" style="text-align: left;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-pca_files/figure-revealjs/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="how-many-principal-components-to-use" class="slide level2">
<h2>How many principal components to use?</h2>
<p>Intuition: Additional principal components will add smaller and smaller variance</p>
<ul>
<li>Keep adding components until the added variance <em>drops off</em></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(starbucks_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3     PC4     PC5     PC6    PC7
Standard deviation     2.4748 1.3074 1.0571 0.97919 0.67836 0.56399 0.4413
Proportion of Variance 0.5568 0.1554 0.1016 0.08716 0.04183 0.02892 0.0177
Cumulative Proportion  0.5568 0.7122 0.8138 0.90093 0.94276 0.97168 0.9894
                           PC8     PC9    PC10    PC11
Standard deviation     0.28123 0.16874 0.08702 0.04048
Proportion of Variance 0.00719 0.00259 0.00069 0.00015
Cumulative Proportion  0.99657 0.99916 0.99985 1.00000</code></pre>
</div>
</div>
</section>
<section id="create-a-scree-plot-or-elbow-plot" class="slide level2">
<h2>Create a scree plot (or elbow plot)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a>starbucks_pca <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_eig</span>(<span class="at">addlabels =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">100</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">ncol</span>(starbucks_pca<span class="sc">$</span>x)), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05-pca_files/figure-revealjs/scree-plot-1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"><ul>
<li><em>Rule of thumb</em>: horizontal line at <span class="math inline">\(1/p\)</span></li>
</ul>
</section>
<section id="pca-output" class="slide level2">
<h2>PCA output</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># str(starbucks_pca)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Examine the output after running <code>prcomp()</code></p>
<ul>
<li><code>starbucks_pca$sdev</code>: singular values (<span class="math inline">\(\sqrt{\lambda_j}\)</span>)</li>
<li><code>starbucks_pca$rotation</code>: loading matrix (<span class="math inline">\(V\)</span>)</li>
<li><code>starbucks_pca$x</code>: principal component scores matrix (<span class="math inline">\(Z=XV\)</span>)</li>
</ul>
<p>Can use the <code>broom</code> package for tidying <code>prcomp()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(starbucks_pca, <span class="at">matrix =</span> <span class="st">"eigenvalues"</span>) <span class="co"># equivalent to starbucks_pca$sdev</span></span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(starbucks_pca, <span class="at">matrix =</span> <span class="st">"rotation"</span>) <span class="co"># equivalent to starbucks_pca$rotation</span></span>
<span id="cb15-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(starbucks_pca, <span class="at">matrix =</span> <span class="st">"scores"</span>) <span class="co"># equivalent to starbucks_pca$x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proportion-of-variance-explained" class="slide level2">
<h2>Proportion of variance explained</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a>starbucks_pca <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"eigenvalues"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC, <span class="at">y =</span> percent)) <span class="sc">+</span></span>
<span id="cb16-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb16-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">ncol</span>(feat), <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(starbucks_pca<span class="sc">$</span>x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05-pca_files/figure-revealjs/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="cumulative-proportion-of-variance-explained" class="slide level2">
<h2>Cumulative proportion of variance explained</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>starbucks_pca <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"eigenvalues"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC, <span class="at">y =</span> cumulative)) <span class="sc">+</span></span>
<span id="cb17-5"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb17-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-7"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(starbucks_pca<span class="sc">$</span>x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05-pca_files/figure-revealjs/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="remember-the-spelling" class="slide level2">
<h2>Remember the spelling…</h2>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
folks. it's <em>principal</em> (not principle) components analysis.
</p>
— Stephanie Hicks, PhD (<span class="citation" data-cites="stephaniehicks">@stephaniehicks</span>) <a href="https://twitter.com/stephaniehicks/status/1626428875323367424?ref_src=twsrc%5Etfw">February 17, 2023</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</section></section>
<section>
<section id="appendix" class="title-slide slide level1 center">
<h1>Appendix</h1>

</section>
<section id="singular-value-decomposition-svd" class="slide level2">
<h2><a href="https://en.wikipedia.org/wiki/Singular_value_decomposition"><strong>Singular value decomposition (SVD)</strong></a></h2>
<p><span class="math display">\[
X = U D V^T
\]</span></p>
<ul>
<li><p><span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span>: matrices containing the left and right <strong>singular vectors of scaled matrix <span class="math inline">\(X\)</span></strong></p></li>
<li><p><span class="math inline">\(D\)</span>: diagonal matrix of the <strong>singular values</strong></p></li>
</ul>
<div class="fragment">
<ul>
<li>SVD simplifies matrix-vector multiplication as <strong>rotate, scale, and rotate again</strong></li>
</ul>
</div>
<div class="fragment">
<p><span class="math inline">\(V\)</span>: <strong>loading matrix</strong> for <span class="math inline">\(X\)</span> with <span class="math inline">\(\phi_{j}\)</span> as columns</p>
<ul>
<li><span class="math inline">\(Z = X  V\)</span>: PC matrix</li>
</ul>
</div>
<div class="fragment">
<p>Bonus: <strong>Eigenvalue decomposition</strong> (or spectral decomposition)</p>
<ul>
<li><p><span class="math inline">\(V\)</span>: <strong>eigenvectors</strong> of <span class="math inline">\(X^TX\)</span> (covariance matrix, <span class="math inline">\(^T\)</span>: <em>transpose</em>)</p></li>
<li><p><span class="math inline">\(U\)</span>: <strong>eigenvectors</strong> of <span class="math inline">\(XX^T\)</span></p></li>
<li><p>The singular values (diagonal of <span class="math inline">\(D\)</span>) are square roots of the <strong>eigenvalues</strong> of <span class="math inline">\(X^TX\)</span> or <span class="math inline">\(XX^T\)</span></p></li>
<li><p>Meaning that <span class="math inline">\(Z = UD\)</span></p></li>
</ul>
</div>
</section>
<section id="eigenvalues-guide-dimension-reduction" class="slide level2">
<h2>Eigenvalues guide dimension reduction</h2>
<p>We want to choose <span class="math inline">\(p^* &lt; p\)</span> such that we are explaining variation in the data</p>
<div class="fragment">
<p>Eigenvalues <span class="math inline">\(\lambda_j\)</span> for <span class="math inline">\(j \in 1, \dots, p\)</span> indicate <strong>the variance explained by each component</strong></p>
<ul>
<li><p><span class="math inline">\(\displaystyle \sum_j^p \lambda_j = p\)</span>, meaning <span class="math inline">\(\lambda_j \geq 1\)</span> indicates <span class="math inline">\(\text{PC}j\)</span> contains at least one variable’s worth in variability</p></li>
<li><p><span class="math inline">\(\displaystyle \frac{\lambda_j}{p}\)</span>: proportion of variance explained by <span class="math inline">\(\text{PC}j\)</span></p></li>
<li><p>Arranged in descending order so that <span class="math inline">\(\lambda_1\)</span> is largest eigenvalue and corresponds to PC1</p></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Compute the cumulative proportion of variance explained (CVE) with <span class="math inline">\(p^*\)</span> components <span class="math display">\[\text{CVE}_{p^*} = \sum_j^{p*} \frac{\lambda_j}{p}\]</span> Use <a href="https://en.wikipedia.org/wiki/Scree_plot"><strong>scree plot</strong></a> to plot eigenvalues and guide choice for <span class="math inline">\(p^* &lt;p\)</span> by looking for “elbow” (rapid to slow change)</li>
</ul>


</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="https://36-sure.github.io/2025">36-SURE.github.io/2025</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/36-SURE\.github\.io\/2025\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>